{% extends 'base.html' %}
{% block contents %}
{% if user.is_authenticated %}
<div>
    USER: {{ user.username }} 
    <button class="btn btn-default" onclick="location.href='{% url 'logout' %}'">Logout</button>
</div>
{% else %}
    <button class="btn btn-default" onclick="location.href='{% url 'login' %}'">Login</button>
{% endif %}

<table class=table>
    <tr>
        <td>번호</td>
        <td>이름</td>
        <td>제목</td>
        <td>등록일</td>
        <td>조회수</td>
    </tr>

    {% if boards %}
        <ul>
            {% for boardRow in boards %}     
            <tr>
            <td>{{ boardRow.id }}</td>
            <td>{{ boardRow.name }}</td>                
            <td><a href="{% url 'board_view' boardRow.id boards.number %}?searchStr={{searchStr}}">{{ boardRow.subject }}</a></td>
            <td>{{ boardRow.created_date }}</td>
            <td>{{ boardRow.hits }}</td>
            </tr>       
            {% endfor %}
        </ul>
    {% else %}
        <p>No Data.</p>
    {% endif %}
</table>
{% load arithmetic %}
<div class="text-center">
    <ul class="pagination">
        <li>
            <a href="{% url 'board_home' 1 %}?searchStr={{searchStr}}" {% if not boards.page.has_previous %}disabled{% endif %}>&laquo;</a>
        </li>

        {% with active_page=boards.number %}

        {% for page_number in boards.paginator.page_range %}

            {# if we're beyond the first five pages, just show "..." until three pages before the current page #}
            {# e.g. on page 12 show: "... 9 10 11 12" #}
            {% if boards.number > 5 and page_number < boards.number|sub:4 %}
                {# nothing to show #}
            {% elif boards.number > 5 and page_number == boards.number|sub:4 %}
                {# show '...' #}
                <!--<li class="disabled">
                    <a href="{% url 'board_home' boards.number|sub:5 %}?searchStr={{searchStr}}">...</a>
                </li>-->

            {# if we're before the last five pages, just show "..." for pages more than three after the current page #}
            {# e.g. on page 1 of 10 show: "1 2 3 4 ..." #}
            {% elif boards.number < boards.paginator.num_pages|sub:5 and page_number > boards.number|add:4 %}
                {# nothing to show #}
            {% elif boards.number < boards.paginator.num_pages|sub:5 and page_number == boards.number|add:4 %}
                {# show '...' #}
                <!--<li class="disabled">
                    <a href="{% url 'board_home' boards.number|add:5 %}?searchStr={{searchStr}}">...</a>
                </li>-->

            {% else %}
                {# show the page number as normal #}
                <li {% if page_number == boards.number %}class="active"{% endif %} foo="3">
                    <a href="{% url 'board_home' page_number %}?searchStr={{searchStr}}">{{ page_number }}</a>
                </li>
            {% endif %}
             
        {% endfor %}

        {% endwith %}

        <li>
            <a href="{% url 'board_home' boards.paginator.num_pages %}?searchStr={{searchStr}}" {% if not boards.page.has_previous %}disabled{% endif %}>&raquo;</a>
        </li>

    </ul>
</div>

{% if user.is_authenticated %}
<button class="btn btn-default" onclick="location.href='{% url 'board_write' boards.number %}?searchStr={{searchStr}}'">글쓰기</button>
{% endif %}

<div>
<form method='GET'>
    <div class="input-group">
        <input class="form-control" placeholder="글찾기" type=text name=searchStr action="{% url 'board_home' boards.number %}" value={{searchStr}}>
        <span class="input-group-btn">
            <button class="btn btn-default" type="submit">글찾기</button>
        </span>
    </div>
</form>
</div>
{% endblock %}